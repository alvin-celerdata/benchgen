// Copyright 2021-present StarRocks, Inc. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

#include "utils/column_streams.h"

#include <stdexcept>

namespace benchgen::tpcds::internal {
namespace {
static const std::array<int, kMaxColumn + 1> kSeeds = {
    0,   0,   15, 10, 1,   4,   10, 0,  2,   1,  1,   1,   2,  1,   50,   50,
    2,   2,   2,  2,  2,   0,   0,  0,  0,   0,  0,   0,   0,  0,   0,    15,
    1,   1,   2,  1,  1,   1,   1,  1,  1,   1,  1,   100, 1,  2,   28,   28,
    14,  14,  14, 14, 14,  28,  14, 14, 14,  0,  14,  14,  14, 14,  0,    0,
    0,   0,   0,  0,  0,   0,   0,  0,  0,   28, 70,  1,   2,  14,  1,    1,
    1,   1,   2,  1,  1,   1,   1,  42, 14,  14, 1,   14,  1,  0,   0,    0,
    0,   0,   0,  0,  0,   0,   0,  0,  0,   0,  0,   0,   0,  112, 0,    28,
    14,  0,   1,  1,  1,   1,   1,  0,  1,   1,  1,   1,   2,  1,   0,    0,
    1,   1,   23, 1,  2,   1,   1,  1,  1,   1,  1,   1,   1,  1,   1,    1,
    1,   1,   2,  7,  1,   1,   1,  1,  1,   1,  1,   1,   1,  1,   2,    0,
    0,   0,   0,  0,  0,   0,   0,  0,  0,   0,  0,   0,   0,  0,   0,    0,
    0,   0,   0,  0,  0,   0,   0,  0,  0,   0,  0,   2,   1,  1,   1,    1,
    1,   2,   1,  1,  1,   2,   1,  1,  1,   1,  2,   1,   1,  1,   2,    200,
    2,   1,   1,  1,  1,   1,   1,  1,  2,   1,  1,   50,  1,  1,   1,    2,
    1,   2,   1,  2,  1,   1,   1,  1,  1,   1,  1,   1,   1,  1,   1,    1,
    1,   1,   1,  1,  100, 1,   1,  2,  1,   1,  1,   2,   1,  1,   1,    1,
    21,  1,   2,  1,  1,   1,   2,  2,  0,   1,  1,   1,   2,  1,   1,    1,
    100, 2,   1,  1,  1,   1,   1,  1,  1,   1,  1,   1,   1,  1,   1,    1,
    2,   1,   1,  7,  32,  32,  16, 16, 16,  16, 16,  16,  16, 16,  0,    0,
    0,   0,   0,  0,  0,   0,   0,  0,  80,  32, 2,   2,   1,  1,   1,    1,
    1,   1,   16, 1,  1,   0,   0,  0,  0,   0,  0,   0,   0,  0,   0,    0,
    16,  128, 32, 0,  1,   1,   1,  1,  1,   1,  1,   1,   1,  1,   2,    1,
    1,   80,  1,  1,  1,   1,   1,  1,  1,   1,  1,   1,   1,  2,   7,    1,
    1,   1,   1,  2,  1,   1,   1,  1,  1,   1,  1,   1,   1,  2,   1,    32,
    32,  16,  16, 16, 16,  16,  16, 16, 16,  16, 16,  16,  0,  0,   0,    0,
    0,   0,   0,  0,  0,   0,   0,  80, 32,  2,  2,   16,  1,  1,   1,    1,
    1,   2,   2,  1,  1,   16,  16, 16, 16,  16, 1,   1,   1,  0,   0,    0,
    0,   0,   0,  0,  0,   0,   0,  0,  0,   0,  0,   128, 32, 16,  0,    1,
    1,   1,   1,  1,  1,   1,   1,  2,  1,   20, 100, 2,   1,  1,   1,    1,
    1,   1,   1,  1,  1,   1,   1,  1,  1,   2,  7,   70,  0,  0,   0,    0,
    0,   0,   0,  1,  1,   6,   0,  1,  1,   1,  1,   1,   1,  1,   1,    1,
    1,   7,   1,  1,  1,   0,   0,  0,  1,   1,  1,   1,   1,  1,   1,    1,
    0,   1,   1,  10, 1,   0,   1,  2,  1,   1,  1,   1,   1,  100, 1,    0,
    1,   1,   1,  1,  1,   1,   2,  8,  0,   1,  0,   0,   0,  1,   1,    1,
    1,   100, 1,  1,  1,   1,   0,  9,  0,   0,  0,   0,   0,  9,   18,   0,
    0,   0,   0,  0,  0,   0,   0,  9,  72,  9,  9,   0,   0,  0,   10,   0,
    1,   10,  0,  0,  0,   1,   1,  1,  1,   1,  1,   1,   1,  25,  23,   1,
    1,   4,   4,  7,  1,   1,   1,  1,  1,   1,  1,   1,   1,  1,   1,    1,
    1,   1,   1,  1,  1,   1,   1,  1,  1,   1,  0,   0,   0,  1,   1,    2,
    1,   1,   0,  1,  200, 2,   1,  1,  1,   50, 1,   1,   1,  1,   0,    2,
    0,   0,   0,  0,  10,  1,   0,  1,  0,   1,  1,   1,   1,  1,   1,    1,
    0,   0,   0,  0,  0,   0,   0,  0,  100, 1,  1,   1,   0,  1,   0,    1,
    1,   1,   1,  1,  1,   100, 7,  1,  12,  12, 12,  12,  12, 12,  1200, 96,
    12,  0,   0,  10, 1,   1,   1,  1,  1,   0,  0,   1,   1,  1,   0,    1,
    1,   1,   1,  1,  1,   1,   0,  0,  0,   0,  0,   24,  12, 0,   0,    0,
    0,   0,   0,  0,  0,   0,   12, 84, 0,   1,  0,   10,  0,  1,   0,    10,
    1,   10,  1,  1,  1,   1,   2,  1,  1,   1,  1,   100, 1,  12,  0,    12,
    12,  12,  12, 12, 12,  96,  0,  12, 0,   1,  1,   1,   1,  1,   1,    1,
    1,   1,   1,  1,  1,   0,   1,  1,  1,   1,  0,   0,   0,  0,   0,    0,
    24,  12,  12, 84, 1,   1,   1,  0,  1,   1,  1,   1,   1,  1,   0,    0};
}  // namespace

const std::array<int, kMaxColumn + 1>& ColumnSeedsPerRow() { return kSeeds; }

int SeedsPerRow(int column_id) {
  if (column_id < 0 || column_id > kMaxColumn) {
    throw std::out_of_range("column_id out of range");
  }
  return kSeeds[static_cast<size_t>(column_id)];
}

}  // namespace benchgen::tpcds::internal
